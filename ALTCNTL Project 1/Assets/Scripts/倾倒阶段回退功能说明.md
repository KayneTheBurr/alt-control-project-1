# å€¾å€’é˜¶æ®µå›é€€åŠŸèƒ½è¯´æ˜

## ğŸ“‹ æ›´æ–°ä¿¡æ¯

**æ—¥æœŸ**: 2024-10-13  
**ç‰ˆæœ¬**: v1.4.1  
**ç±»å‹**: æ¸¸æˆæœºåˆ¶å¢å¼º

---

## ğŸ¯ æ–°å¢åŠŸèƒ½

åœ¨å€¾å€’é˜¶æ®µï¼ˆLeftTopple/RightToppleï¼‰ï¼Œç©å®¶ç°åœ¨å¯ä»¥æŒ‰**åæ–¹å‘**çš„å€¾æ–œé”®æ¥å›é€€åˆ°ä¸Šä¸€çº§å€¾æ–œé˜¶æ®µã€‚

---

## ğŸ® å·¥ä½œæœºåˆ¶

### å·¦å€¾å€’é˜¶æ®µ (LeftTopple)

**å½“å‰çŠ¶æ€**ï¼šå·¦å€¾å€’ï¼ˆç‰©å“æ­£åœ¨æ‰è½ï¼‰

**æŒ‰é”®æ“ä½œ**ï¼š
- æŒ‰ **3é”®**ï¼ˆå‘å³å€¾æ–œï¼‰â†’ å›é€€åˆ° **å·¦å€¾2** âœ…
- æŒ‰ **2é”®**ï¼ˆå‘å·¦å€¾æ–œï¼‰â†’ æ— æ•ˆæœ âŒ

```
å·¦å€¾å€’ â”€â”€â”€â”€â”€â”€3é”®â”€â”€â”€â”€â†’ å·¦å€¾2
   â†‘                    
   â””â”€â”€ 2é”®ï¼ˆæ— æ•ˆæœï¼‰
```

### å³å€¾å€’é˜¶æ®µ (RightTopple)

**å½“å‰çŠ¶æ€**ï¼šå³å€¾å€’ï¼ˆç‰©å“æ­£åœ¨æ‰è½ï¼‰

**æŒ‰é”®æ“ä½œ**ï¼š
- æŒ‰ **2é”®**ï¼ˆå‘å·¦å€¾æ–œï¼‰â†’ å›é€€åˆ° **å³å€¾2** âœ…
- æŒ‰ **3é”®**ï¼ˆå‘å³å€¾æ–œï¼‰â†’ æ— æ•ˆæœ âŒ

```
å³å€¾å€’ â”€â”€â”€â”€â”€â”€2é”®â”€â”€â”€â”€â†’ å³å€¾2
   â†‘                    
   â””â”€â”€ 3é”®ï¼ˆæ— æ•ˆæœï¼‰
```

---

## ğŸ“Š å®Œæ•´é˜¶æ®µè½¬æ¢å›¾

```
         æŒ‰3é”®å›é€€
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚              â†“
å·¦å€¾å€’ â† å·¦å€¾2 â† å·¦å€¾1 â† å±…ä¸­ â†’ å³å€¾1 â†’ å³å€¾2 â†’ å³å€¾å€’
                                                â†‘      â”‚
                                                â””â”€â”€â”€â”€â”€â”€â”˜
                                              æŒ‰2é”®å›é€€
```

---

## ğŸ”§ æŠ€æœ¯å®ç°

### ä¿®æ”¹çš„æ–¹æ³•ï¼šTryMovePhase

```csharp
public void TryMovePhase(int direction)
{
    // ... å‰ç½®æ£€æŸ¥
    
    // ç‰¹æ®Šå¤„ç†ï¼šåœ¨å€¾å€’é˜¶æ®µæ—¶ï¼Œåªå…è®¸åæ–¹å‘å›é€€
    if (currentPhase.IsTopplePhase())
    {
        // åœ¨å·¦å€¾å€’é˜¶æ®µ
        if (currentPhase == SwayPhase.LeftTopple)
        {
            if (direction > 0) // æŒ‰å‘å³é”®ï¼ˆåæ–¹å‘ï¼‰
            {
                targetPhase = SwayPhase.LeftTilt2;
                ChangePhase(targetPhase);
            }
            return;
        }
        // åœ¨å³å€¾å€’é˜¶æ®µ
        else if (currentPhase == SwayPhase.RightTopple)
        {
            if (direction < 0) // æŒ‰å‘å·¦é”®ï¼ˆåæ–¹å‘ï¼‰
            {
                targetPhase = SwayPhase.RightTilt2;
                ChangePhase(targetPhase);
            }
            return;
        }
        return;
    }
    
    // æ­£å¸¸å€¾æ–œé˜¶æ®µçš„ç§»åŠ¨é€»è¾‘...
}
```

### æ ¸å¿ƒé€»è¾‘

1. **æ£€æµ‹å€¾å€’é˜¶æ®µ**
   ```csharp
   if (currentPhase.IsTopplePhase())
   ```

2. **åˆ¤æ–­æ–¹å‘**
   - å·¦å€¾å€’ + å‘å³é”®ï¼ˆåæ–¹å‘ï¼‰â†’ å…è®¸
   - å·¦å€¾å€’ + å‘å·¦é”®ï¼ˆåŒæ–¹å‘ï¼‰â†’ å¿½ç•¥
   - å³å€¾å€’ + å‘å·¦é”®ï¼ˆåæ–¹å‘ï¼‰â†’ å…è®¸
   - å³å€¾å€’ + å‘å³é”®ï¼ˆåŒæ–¹å‘ï¼‰â†’ å¿½ç•¥

3. **æ‰§è¡Œå›é€€**
   ```csharp
   ChangePhase(targetPhase); // åˆ‡æ¢åˆ°å€¾2é˜¶æ®µ
   ```

---

## ğŸ® æ¸¸æˆæ€§å½±å“

### ä¼˜åŠ¿

1. **å¢åŠ ç”Ÿå­˜æœºä¼š**
   - ç©å®¶åœ¨å€¾å€’é˜¶æ®µæœ‰æœºä¼šæŒ½æ•‘å±€é¢
   - ä¸å†æ˜¯"ä¸€å€¾å€’å°±æ— æ³•æŒ½å›"
   - æå‡å®¹é”™ç‡

2. **æå‡æŠ€å·§æ·±åº¦**
   - ç©å®¶éœ€è¦å¿«é€Ÿååº”
   - å¢åŠ æ“ä½œæŠ€å·§çš„é‡è¦æ€§
   - å¥–åŠ±ç†Ÿç»ƒç©å®¶

3. **æ›´æµç•…çš„æ¸¸æˆä½“éªŒ**
   - å‡å°‘æŒ«è´¥æ„Ÿ
   - æ›´å¤šæ“ä½œç©ºé—´
   - æ¸¸æˆèŠ‚å¥æ›´å¥½

### å¹³è¡¡è€ƒè™‘

**å¯èƒ½çš„é—®é¢˜**ï¼š
- âš ï¸ æ¸¸æˆéš¾åº¦å¯èƒ½é™ä½
- âš ï¸ å€¾å€’é˜¶æ®µå¨èƒæ€§å‡å¼±

**å»ºè®®å¹³è¡¡æ–¹æ¡ˆ**ï¼š

1. **å¢åŠ å›é€€æˆæœ¬**
   ```csharp
   // å›é€€æ—¶é¢å¤–æ‰è½1ä¸ªç‰©å“
   if (direction > 0 && currentPhase == SwayPhase.LeftTopple)
   {
       OnToppleDrop?.Invoke(); // å…ˆæ‰ä¸€ä¸ª
       targetPhase = SwayPhase.LeftTilt2;
       ChangePhase(targetPhase);
   }
   ```

2. **é™åˆ¶å›é€€æ¬¡æ•°**
   ```csharp
   private int toppleRecoverCount = 0;
   public int maxToppleRecovers = 2; // æ¯å±€æœ€å¤šå›é€€2æ¬¡
   
   // åœ¨å›é€€é€»è¾‘ä¸­æ£€æŸ¥
   if (toppleRecoverCount >= maxToppleRecovers)
   {
       Debug.Log("å·²è¾¾åˆ°å›é€€ä¸Šé™ï¼");
       return;
   }
   toppleRecoverCount++;
   ```

3. **å¢åŠ å›é€€å†·å´**
   ```csharp
   private float lastRecoverTime = 0f;
   public float recoverCooldown = 3f; // 3ç§’å†·å´
   
   if (Time.time - lastRecoverTime < recoverCooldown)
   {
       Debug.Log("å›é€€å†·å´ä¸­...");
       return;
   }
   lastRecoverTime = Time.time;
   ```

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯1ï¼šä»å·¦å€¾å€’æŒ½æ•‘

```
1. ç©å®¶å †å ç‰©å“è¿‡å¤šï¼Œè§¦å‘å·¦å€¾å€’
2. ç‰©å“å¼€å§‹æ‰è½
3. ç©å®¶å¿«é€ŸæŒ‰ 3é”®ï¼ˆå‘å³ï¼‰
4. ç³»ç»Ÿåˆ‡æ¢åˆ°å·¦å€¾2é˜¶æ®µ
5. åœæ­¢æ‰è½å¾ªç¯ï¼Œè¿›å…¥å€¾æ–œå€’è®¡æ—¶
6. ç©å®¶ç»§ç»­è°ƒæ•´å¹³è¡¡
```

### åœºæ™¯2ï¼šä»å³å€¾å€’æŒ½æ•‘

```
1. å› ä¸ºè‡ªåŠ¨å€¾æ–œè¿›å…¥å³å€¾å€’
2. é¡¶éƒ¨ç‰©å“æ‰è½
3. ç©å®¶æŒ‰ 2é”®ï¼ˆå‘å·¦ï¼‰
4. å›é€€åˆ°å³å€¾2
5. æœ‰5ç§’æ—¶é—´è°ƒæ•´
6. ç©å®¶ç§»åŠ¨åˆ°å±…ä¸­
```

### åœºæ™¯3ï¼šåŒæ–¹å‘æŒ‰é”®æ— æ•ˆ

```
1. å½“å‰åœ¨å·¦å€¾å€’
2. ç©å®¶è¯¯æŒ‰ 2é”®ï¼ˆå‘å·¦ï¼ŒåŒæ–¹å‘ï¼‰
3. æ— ä»»ä½•ååº”
4. ç»§ç»­æ‰è½
5. ç©å®¶æ”¹æŒ‰ 3é”®ï¼ˆå‘å³ï¼‰
6. æˆåŠŸå›é€€
```

---

## ğŸ§ª æµ‹è¯•å»ºè®®

### åŠŸèƒ½æµ‹è¯•

```
æµ‹è¯•1ï¼šå·¦å€¾å€’ â†’ æŒ‰3é”®
  é¢„æœŸï¼šå›é€€åˆ°å·¦å€¾2ï¼Œåœæ­¢æ‰è½ï¼Œå¼€å§‹å€¾æ–œå€’è®¡æ—¶

æµ‹è¯•2ï¼šå·¦å€¾å€’ â†’ æŒ‰2é”®
  é¢„æœŸï¼šæ— æ•ˆæœï¼Œç»§ç»­æ‰è½

æµ‹è¯•3ï¼šå³å€¾å€’ â†’ æŒ‰2é”®
  é¢„æœŸï¼šå›é€€åˆ°å³å€¾2ï¼Œåœæ­¢æ‰è½ï¼Œå¼€å§‹å€¾æ–œå€’è®¡æ—¶

æµ‹è¯•4ï¼šå³å€¾å€’ â†’ æŒ‰3é”®
  é¢„æœŸï¼šæ— æ•ˆæœï¼Œç»§ç»­æ‰è½

æµ‹è¯•5ï¼šå›é€€åå†æ¬¡å€¾æ–œ
  é¢„æœŸï¼šå¯ä»¥æ­£å¸¸å‘å„ä¸ªæ–¹å‘å€¾æ–œ
```

### è¾¹ç•Œæµ‹è¯•

```
æµ‹è¯•6ï¼šè½¬æ¢åŠ¨ç”»ä¸­æŒ‰å›é€€é”®
  é¢„æœŸï¼šè¢«å¿½ç•¥ï¼ˆisTransitioningæ£€æŸ¥ï¼‰

æµ‹è¯•7ï¼šè¿ç»­å¿«é€ŸæŒ‰å›é€€é”®
  é¢„æœŸï¼šåªæ‰§è¡Œä¸€æ¬¡å›é€€

æµ‹è¯•8ï¼šå›é€€åç«‹å³æŒ‰1/4é”®
  é¢„æœŸï¼šå¯ä»¥ç«‹å³è¿›å…¥å€¾å€’
```

---

## ğŸ¯ ç©å®¶ç­–ç•¥

### è¿›æ”»å‹ç©æ³•

```
ç­–ç•¥ï¼šåˆ©ç”¨å€¾å€’å¿«é€Ÿä¸¢å¼ƒ
1. ä¸»åŠ¨æŒ‰1æˆ–4è¿›å…¥å€¾å€’
2. ä¸¢å¼ƒå‡ ä¸ªç‰©å“
3. æŒ‰åæ–¹å‘é”®å›é€€
4. ç»§ç»­æ¸¸æˆ
```

### é˜²å®ˆå‹ç©æ³•

```
ç­–ç•¥ï¼šè°¨æ…ä½¿ç”¨å›é€€ä½œä¸ºå®‰å…¨ç½‘
1. å°½é‡é¿å…è¿›å…¥å€¾å€’
2. åªåœ¨æ„å¤–å€¾å€’æ—¶ä½¿ç”¨å›é€€
3. å›é€€åç«‹å³ç¨³å®šåˆ°å±…ä¸­
4. ä¿å®ˆæ“ä½œ
```

### é«˜æ‰‹ç©æ³•

```
ç­–ç•¥ï¼šç²¾ç¡®æ§åˆ¶å€¾å€’æ—¶æœº
1. è®¡ç®—å¥½ä½•æ—¶éœ€è¦ä¸¢å¼ƒ
2. åˆ©ç”¨å€¾å€’å¿«é€Ÿè°ƒæ•´å †å 
3. ç²¾ç¡®æŠŠæ¡å›é€€æ—¶æœº
4. æœ€å¤§åŒ–å¾—åˆ†
```

---

## ğŸ“Š æ•°æ®å¯¹æ¯”

### ä¿®æ”¹å‰

| é˜¶æ®µ | å¯å›é€€ | æŒ½æ•‘æœºä¼š |
|------|--------|---------|
| å·¦å€¾å€’ | âŒ | æ—  |
| å³å€¾å€’ | âŒ | æ—  |

**ç‰¹ç‚¹**ï¼š
- è¿›å…¥å€¾å€’ = å¿…ç„¶æ‰è½
- é«˜æƒ©ç½šæ€§
- å®¹é”™ç‡ä½

### ä¿®æ”¹å

| é˜¶æ®µ | å¯å›é€€ | æŒ½æ•‘æœºä¼š |
|------|--------|---------|
| å·¦å€¾å€’ | âœ… æŒ‰3é”® | 1æ¬¡ |
| å³å€¾å€’ | âœ… æŒ‰2é”® | 1æ¬¡ |

**ç‰¹ç‚¹**ï¼š
- è¿›å…¥å€¾å€’ â‰  å¿…ç„¶å¤±è´¥
- æœ‰æŒ½æ•‘æœºä¼š
- å®¹é”™ç‡æå‡

---

## ğŸ’¡ UIæç¤ºå»ºè®®

### å±å¹•æç¤º

å½“è¿›å…¥å€¾å€’é˜¶æ®µæ—¶æ˜¾ç¤ºï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   âš ï¸ å€¾å€’é˜¶æ®µï¼                â”‚
â”‚                                â”‚
â”‚   æŒ‰ [3] é”®å›é€€åˆ°å·¦å€¾2          â”‚
â”‚                                â”‚
â”‚   å¿«é€Ÿååº”å¯ä»¥æŒ½æ•‘ï¼            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å®ç°ç¤ºä¾‹

```csharp
void OnPhaseChanged(SwayPhase oldPhase, SwayPhase newPhase)
{
    if (newPhase == SwayPhase.LeftTopple)
    {
        ShowTip("æŒ‰ [3] é”®å¯ä»¥å›é€€ï¼", 2f);
    }
    else if (newPhase == SwayPhase.RightTopple)
    {
        ShowTip("æŒ‰ [2] é”®å¯ä»¥å›é€€ï¼", 2f);
    }
}
```

---

## ğŸ”Š éŸ³æ•ˆå»ºè®®

### å›é€€æˆåŠŸéŸ³æ•ˆ

```csharp
void TryMovePhase(int direction)
{
    // ... å›é€€é€»è¾‘
    if (ä»å€¾å€’å›é€€æˆåŠŸ)
    {
        AudioSource.PlayClipAtPoint(recoverSound, Vector3.zero);
        ShowRecoverEffect(); // æ˜¾ç¤ºç‰¹æ•ˆ
    }
}
```

### å»ºè®®éŸ³æ•ˆç±»å‹

- **å›é€€æˆåŠŸ**ï¼šæ¸…è„†çš„"å®"å£°
- **å›é€€å¤±è´¥**ï¼šä½æ²‰çš„"å’š"å£°
- **åŒæ–¹å‘æŒ‰é”®**ï¼šæ— éŸ³æ•ˆï¼ˆé™é»˜ï¼‰

---

## ğŸ“ˆ é¢„æœŸå½±å“

### æ¸¸æˆéš¾åº¦

- æ•´ä½“éš¾åº¦ï¼š**ç•¥å¾®é™ä½**
- æ–°æ‰‹å‹å¥½åº¦ï¼š**æ˜¾è‘—æå‡**
- é«˜æ‰‹æ“ä½œç©ºé—´ï¼š**å¢åŠ **

### æ¸¸æˆæ—¶é•¿

- å¹³å‡ç”Ÿå­˜æ—¶é—´ï¼š**+20-30%**
- æœ€é«˜å¾—åˆ†ï¼š**å¯èƒ½æå‡**
- å›åˆæ•°ï¼š**å¯èƒ½å‡å°‘**

### ç©å®¶åé¦ˆ

é¢„æœŸç§¯æåé¦ˆï¼š
- âœ… æ›´å…¬å¹³
- âœ… æœ‰æŒ½æ•‘æœºä¼š
- âœ… æ“ä½œæ„Ÿæ›´å¥½

é¢„æœŸè´Ÿé¢åé¦ˆï¼š
- âš ï¸ å¤ªç®€å•
- âš ï¸ ç¼ºä¹ç´§å¼ æ„Ÿ

---

## ğŸ”— ç›¸å…³æ–‡ä»¶

**ä¿®æ”¹çš„æ–‡ä»¶**ï¼š
- `SwayController.cs`

**ç›¸å…³ç³»ç»Ÿ**ï¼š
- `StackController.cs` - æ‰è½ç®¡ç†
- `SwayPhaseSlider.cs` - UIæ˜¾ç¤º

---

## âœ… æ£€æŸ¥æ¸…å•

åœ¨å®ç°å›é€€åŠŸèƒ½åï¼Œç¡®è®¤ï¼š

- [x] å·¦å€¾å€’å¯ä»¥å›é€€åˆ°å·¦å€¾2
- [x] å³å€¾å€’å¯ä»¥å›é€€åˆ°å³å€¾2
- [x] åŒæ–¹å‘æŒ‰é”®æ— æ•ˆ
- [x] å›é€€ååœæ­¢æ‰è½å¾ªç¯
- [x] å›é€€åå¯åŠ¨å€¾æ–œå€’è®¡æ—¶
- [x] è½¬æ¢åŠ¨ç”»æ­£å¸¸
- [x] äº‹ä»¶ç³»ç»Ÿæ­£å¸¸è§¦å‘
- [x] UI Slideræ­£ç¡®æ›´æ–°

---

## ğŸ“ ç‰ˆæœ¬å†å²

**v1.4.1** (2024-10-13)
- âœ… æ·»åŠ å€¾å€’é˜¶æ®µå›é€€åŠŸèƒ½
- âœ… ä¿®æ”¹ TryMovePhase æ–¹æ³•
- âœ… å¢åŠ è°ƒè¯•æ—¥å¿—

**v1.4.0** (2024-10-13)
- è¾“å…¥ç³»ç»Ÿé‡æ„ï¼ˆ1234é”®ï¼‰

**v1.3.1** (2024-10-13)
- UI Slideræ–¹å‘åå‘

---

## ğŸ‰ æ€»ç»“

è¿™ä¸ªæ–°åŠŸèƒ½ä¸ºç©å®¶æä¾›äº†ä»å€¾å€’é˜¶æ®µæ¢å¤çš„æœºä¼šï¼Œæå‡äº†æ¸¸æˆçš„å®¹é”™ç‡å’Œå¯ç©æ€§ã€‚

**æ ¸å¿ƒä»·å€¼**ï¼š
- æ›´å‹å¥½çš„æ¸¸æˆä½“éªŒ
- æ›´å¤šçš„ç­–ç•¥æ·±åº¦
- æ›´é«˜çš„æŠ€å·§å¤©èŠ±æ¿

**å»ºè®®**ï¼š
- æ ¹æ®æµ‹è¯•åé¦ˆè°ƒæ•´å¹³è¡¡
- è€ƒè™‘æ·»åŠ æˆæœ¬æœºåˆ¶
- æ·»åŠ è§†è§‰/éŸ³æ•ˆåé¦ˆ

ç°åœ¨è¿è¡Œæ¸¸æˆæµ‹è¯•ï¼Œåœ¨å€¾å€’é˜¶æ®µæŒ‰åæ–¹å‘é”®è¯•è¯•ï¼ğŸ®

---

**æ›´æ–°æ—¥æœŸ**: 2024-10-13  
**ç‰ˆæœ¬**: v1.4.1  
**ç±»å‹**: æ¸¸æˆæœºåˆ¶å¢å¼º

